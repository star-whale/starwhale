---
title: Runtime CLI
---

## Usage

```bash
swcli runtime [OPTIONS] COMMAND [ARGS]...
```

## Summary

- Commands for runtime lifecycle management.
- For standalone instances, the `runtime` command uses the local disk to create, build and store Starwhale Runtime.
- For cloud instances, the `runtime` command manages the remote cloud datasets with HTTP API.
- `Starwhale Runtime` uses conda or virutalenv as the python environment fundamental. If you use conda, please install conda first.
- **Runtime URI** in format: `[<Project URI>/runtime]<runtime name>[/version/<version id>]`.

## All Sub-Commands

  |Command|Standalone|Cloud|
  |-------|----------|-----|
  |create|✅|❌|
  |build|✅|❌|
  |history|✅|✅|
  |info|✅|✅|
  |list|✅|✅|
  |recover|✅|✅|
  |remove|✅|✅|
  |tag|✅|❌|
  |activate|✅|❌|
  |extract|✅|❌|
  |restore|✅|❌|
  |copy|✅|✅|

## Create a runtime

```bash
swcli runtime create [OPTIONS] WORKDIR
```

- This command will create a Starwhale runtime in working dir, automatically generating a `runtime.yaml`, a virtualenv venv directory, or a conda environment. The created runtime will include the specified starwhale version automatically.
- In the `venv` mode, swcli only supports the installed versions of system python3 as the `--python` option.
- Options:

    |Option|Alias Option|Required|Type|Default|Description|
    |------|--------|-------|-----------|-----|-----------|
    |`--name`|`-n`|✅|String||Runtime name|
    |`--mode`|`-m`|❌|String Choice: venv or conda|venv|Runtime Mode:venv or conda|
    |`--python`||❌|String|3.8|Python Version|
    |`--force`|`-f`|❌|Boolean|False|Force to create runtime|

- Example:

    ```bash
    ❯ swcli runtime create -n pytorch-mnist -m venv --python 3.8 --force .
    🚧 start to create runtime environment...
    👏 create venv@/home/liutianwei/tmp/test-venv/venv, python:3.8.10 (default, Nov 26 2021, 20:14:08)
    [GCC 9.3.0]
    🐶 install starwhale venv@/home/liutianwei/tmp/test-venv/venv...
    🍰 run command in shell 🍰
            source /home/liutianwei/tmp/test-venv/venv/bin/activate
    👏 python runtime environment is ready to use 🎉
    ```

## Build a runtime

```bash
swcli runtime build [OPTIONS] WORKDIR
```

- This command builds a runtime with the specified working directory. The working dir must contain a `runtime.yaml`, which will be generated by the `swcli runtime create` command.
- By default, the built runtime will ignore machine architecture and os limitations. When you set the `--gen-all-bundles` option, it will copy all python files of the dependencies in the current machine environment. Larger, system-related, but no network dependency at the restoring phase.
- Options

    |Option|Alias Option|Required|Type|Default|Description|
    |------|--------|-------|-----------|-----|-----------|
    |`--project`|`-p`|❌|String|Selected project|Project URI|
    |`--runtime-yaml`|`-f`|❌|String|runtime.yaml|Runtime yaml filename, default is ${WORKDIR}/runtime.yaml|
    |`--gen-all-bundles`||❌|Boolean|False|Generate conda or venv files into runtime, which will generate a large runtime bundle file|
    |`--include-editable`||❌|Boolean|False|Include editable packages|

- Example:

    ```bash
    ❯ swcli runtime build .
    🚧 start to build runtime bundle...
    👷 uri:local/project/self/runtime/pytorch-mnist
    🐦 runtime will ignore pypi editable package
    🆕 version gaygeyjqmu4d
    📁 workdir: /home/liutianwei/.cache/starwhale/self/workdir/runtime/pytorch-mnist/ga/gaygeyjqmu4diyzsga3dazlfhbvhk5y
    💫 python3.8.10@venv, os(Linux), include-editable(False), try to export environment...
    🌈 runtime docker image: ghcr.io/star-whale/starwhale:0.2.0b9  🌈
    🦋 .swrt bundle:/home/liutianwei/.cache/starwhale/self/runtime/pytorch-mnist/ga/gaygeyjqmu4diyzsga3dazlfhbvhk5y.swrt
    7 out of 7 steps finished ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00 0:00:00
    ```

## Activate runtime python environment

```bash
swcli runtime activate [OPTIONS] WORKDIR
```

- This command shows the venv or conda activate command for the runtime. Using this command, you need not memorize different environment activate commands.
- The activate command will read and reflect the runtime.yaml of the working dir.
- Options:

    |Option|Alias Option|Required|Type|Default|Description|
    |------|--------|-------|-----------|-----|-----------|
    |`--runtime-yaml`|`-f`|❌|String|runtime.yaml|Runtime yaml filename, default is ${WORKDIR}/runtime.yaml|

- Example:

    ```bash
    ❯ swcli runtime activate .
    🍰 run command in shell 🍰
        source ./venv/bin/activate
    ```

## Extract runtime bundle

```bash
swcli runtime extract [OPTIONS] RUNTIME
```

- This command extracts the bundled runtime to target dir. When you copy a runtime from a remote cloud instance to the local standalone instance, you can extract it and then do some operations, such as activate and restore.
- The `RUNTIME` argument uses the `Runtime URI` format, which must include the `/version/{version id}` part.
- Options:

    |Option|Alias Option|Required|Type|Default|Description|
    |------|--------|-------|-----------|-----|-----------|
    |`--force`|`-f`|❌|Boolean|False|Force to extract runtime|
    |`--target-dir`||❌|String|Starwhale default runtime workdir|Extract target dir|

- Example:

    ```bash
    ❯ swcli runtime extract mnist/version/latest --force
    🚔 try to extract ...
    👏 extracted @ /home/liutianwei/.cache/starwhale/self/workdir/runtime/mnist/g4/g4zwkyjumm2dinrtmftdgyjznb4xcni 🎉
    ```

## Restore runtime python environment

```bash
swcli runtime restore [OPTIONS] TARGET
```

- This command will prepare dirs, restore python environment with virtualenv or conda, and show activate command. It will help you create a runtime environment, then run an evaluation job or build a dataset.
- `TARGET` argument is `RUNTIME URI` or runtime working dir path.
- Restore python environment will run `pip install` command to download python packages, which may take some time.
- In the Starwhale agent docker environment, only the working dir path is supported.

- Example:

    ```bash
    ❯ swcli runtime restore mnist/version/g4zwkyjumm2d
    🏌 try to restore python runtime environment/home/liutianwei/.cache/starwhale/self/workdir/runtime/mnist/g4/g4zwkyjumm2dinrtmftdgyjznb4xcni ...
    🍞 restore python:3.7.13 venv@/home/liutianwei/.cache/starwhale/self/workdir/runtime/mnist/g4/g4zwkyjumm2dinrtmftdgyjznb4xcni, use local env data: False
    👏 create venv@/home/liutianwei/.cache/starwhale/self/workdir/runtime/mnist/g4/g4zwkyjumm2dinrtmftdgyjznb4xcni/dep/python/venv, python:3.7.13 (default, Mar 29 2022, 02:18:16)
    [GCC 7.5.0]
     👏 activate.sw and activate.host is generated at /home/liutianwei/.cache/starwhale/self/workdir/runtime/mnist/g4/g4zwkyjumm2dinrtmftdgyjznb4xcni
     🧭 run cmd:
             Docker Container:  $(sh /home/liutianwei/.cache/starwhale/self/workdir/runtime/mnist/g4/g4zwkyjumm2dinrtmftdgyjznb4xcni/activate.sw)
             Host:  $(sh /home/liutianwei/.cache/starwhale/self/workdir/runtime/mnist/g4/g4zwkyjumm2dinrtmftdgyjznb4xcni/activate.host)
    ```

## List runtimes

```bash
swcli runtime list [OPTIONS]
```

- This command lists all runtimes in the project.
- Options:

    |Option|Alias Option|Required|Type|Default|Description|
    |------|--------|-------|-----------|-----|-----------|
    |`--project`|`-p`|❌|String|Selected project|Project URI|
    |`--fullname`||❌|Boolean|False|Show fullname of runtime version|
    |`--show-removed`||❌|Boolean|False|Show removed runtimes|
    |`--page`||❌|Integer|1|Page number for runtime list|
    |`--size`||❌|Integer|20|Page size for runtime list|

## Get runtime info

```bash
swcli runtime info [OPTIONS] RUNTIME
```

- This command inspects the runtime details.
- `RUNTIME` argument uses the `Runtime URI` format so that you can inspect the whole runtime or a specified-version runtime.
- Options:

    |Option|Alias Option|Required|Type|Default|Description|
    |------|--------|-------|-----------|-----|-----------|
    |`--fullname`||❌|Boolean|False|Show version fullname|

## Show runtime history

```bash
swcli runtime history [OPTIONS] RUNTIME
```

- This command shows the history of a runtime and lists all its versions.
- `RUNTIME` argument uses the `Runtime URI` format.
- Options:

    |Option|Alias Option|Required|Type|Default|Description|
    |------|--------|-------|-----------|-----|-----------|
    |`--fullname`||❌|Boolean|False|Show version fullname|

- Example:

    ```bash
    ❯ swcli runtime history mnist --fullname
    ```

## Manage runtime tags

```bash
swcli runtime tag [OPTIONS] RUNTIME TAGS
```

- This command adds or removes tags on the specified version of a runtime.
- The `RUNTIME` argument uses the `Runtime URI` format, which must include `/version/{version id}` part.
- You can write one or more `TAG` arguments.
- Options:

    |Option|Alias Option|Required|Type|Default|Description|
    |------|--------|-------|-----------|-----|-----------|
    |`--remove`|`-r`|❌|Boolean|False|Remove tags|
    |`--quiet`|`-q`|❌|Boolean|False|Ignore tag name errors like name duplication, name absence|

- Example:

    ```bash
    ❯ swcli runtime tag mnist/version/g43tsodfg5sd v2 test
    ```

## Remove a runtime

```bash
swcli dataset remove [OPTIONS] RUNTIME
```

- This command removes a runtime. You can run `swcli runtime recover` to recover the removed runtimes.
- The `RUNTIME` argument uses the `Runtime URI` format so that you can remove the whole runtime or a specified-version runtime.
- Support the short version or tag in the `Runtime URI` format when you remove a runtime.
- Options:

    |Option|Alias Option|Required|Type|Default|Description|
    |------|--------|-------|-----------|-----|-----------|
    |`--force`|`-f`|❌|Boolean|False|Force to remove runtime|

- Example:

    ```bash
    ❯ swcli runtime remove mnist/version/v2
    continue to remove? [y/N]: y
    👏 do successfully
    ```

## Recover a runtime

```bash
swcli runtime recover [OPTIONS] RUNTIME
```

- This command recovers a removed runtime. You can run `swcli runtime list --show-removed` to fetch removed runtimes.
- `RUNTIME` argument uses the `Runtime URI` format so that you can recover the whole runtime or a specified-version runtime.
- Only support the full version in the `Runtime URI` format when you recover a runtime.
- Options:

    |Option|Alias Option|Required|Type|Default|Description|
    |------|--------|-------|-----------|-----|-----------|
    |`--force`|`-f`|❌|Boolean|False|Force to recover runtime|

- Example:

    ```bash
    ❯ swcli runtime recover mnist/version/g43tsodfg5sdqnrtmftdgyjzo5zdgoi
    👏 do successfully
    ```

## Copy a runtime

```bash
swcli runtime copy [OPTIONS] SRC DEST
```

- This command copies a runtime to another place, either locally or remotely.
- `SRC` uses `Runtime URI`, which can locate one existing runtime version in the standalone or cloud instance.
- `DEST` uses `Project URI`, which implies the storage project in the destination instance. If the `DEST` project has already stored the same name and version runtime, you can set the `--force` argument to force update.
- Today, this command supports copy runtime from standalone to cloud and from cloud to standalone. `standalone -> standalone` or `cloud -> cloud` is not supported.
- Options:

    |Option|Alias Option|Required|Type|Default|Description|
    |------|--------|-------|-----------|-----|-----------|
    |`--force`|`-f`|❌|Boolean|False|Force to copy runtime|

- Example: copy a runtime from the local standalone instance to a remote cloud instance(upload)

    ```bash
    ❯ swcli runtime copy mnist/version/latest cloud://pre-k8s/project/1 --force
    🚧 start to copy local/project/self/runtime/mnist/version/latest -> http://console.pre.intra.starwhale.ai/project/1...
    🎳 upload g4zwkyjumm2dinrtmftdgyjznb4xcni.swrt ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00 10.2 kB ?
    👏 copy done.
    ```

- Example: copy a runtime from a remote cloud instance to the local standalone instance(download)

    ```bash
    ❯ swcli runtime copy cloud://pre-k8s/project/1/runtime/mnist/version/g4zwkyjumm2dinrtmftdgyjznb4xcni self --force
    🚧 start to copy http://console.pre.intra.starwhale.ai/project/1/runtime/mnist/version/g4zwkyjumm2dinrtmftdgyjznb4xcni -> local/project/self...
    🎳 download to /home/liutianwei/.cache/starwhale/self/runtime/mnist/g4/g4zwkyjumm2dinrtmftdgyjznb4xcni.swrt... ━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00 1 byte ?👏 copy done.
    ```
