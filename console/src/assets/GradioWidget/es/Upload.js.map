{"version":3,"file":"Upload.js","sources":["../../upload/src/Upload.svelte"],"sourcesContent":["<script lang=\"ts\">\n\timport { createEventDispatcher } from \"svelte\";\n\timport type { FileData } from \"./types\";\n\n\texport let filetype: string | undefined = undefined;\n\texport let include_file_metadata = true;\n\texport let dragging = false;\n\texport let boundedheight: boolean = true;\n\texport let center: boolean = true;\n\texport let flex: boolean = true;\n\texport let file_count: string = \"single\";\n\texport let disable_click = false;\n\n\tlet hidden_upload: HTMLInputElement;\n\n\tconst dispatch = createEventDispatcher();\n\n\tconst updateDragging = () => {\n\t\tdragging = !dragging;\n\t};\n\n\tconst openFileUpload = () => {\n\t\tif (disable_click) return;\n\t\thidden_upload.value = \"\";\n\t\thidden_upload.click();\n\t};\n\n\tconst loadFiles = (files: FileList) => {\n\t\tlet _files: Array<File> = Array.from(files);\n\t\tif (!files.length || !window.FileReader) {\n\t\t\treturn;\n\t\t}\n\t\tif (file_count === \"single\") {\n\t\t\t_files = [files[0]];\n\t\t}\n\t\tvar all_file_data: Array<FileData | string> = [];\n\t\t_files.forEach((f, i) => {\n\t\t\tlet ReaderObj = new FileReader();\n\t\t\tReaderObj.readAsDataURL(f);\n\t\t\tReaderObj.onloadend = function () {\n\t\t\t\tall_file_data[i] = include_file_metadata\n\t\t\t\t\t? {\n\t\t\t\t\t\t\tname: f.name,\n\t\t\t\t\t\t\tsize: f.size,\n\t\t\t\t\t\t\tdata: this.result as string\n\t\t\t\t\t  }\n\t\t\t\t\t: (this.result as string);\n\t\t\t\tif (\n\t\t\t\t\tall_file_data.filter((x) => x !== undefined).length === files.length\n\t\t\t\t) {\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\t\"load\",\n\t\t\t\t\t\tfile_count == \"single\" ? all_file_data[0] : all_file_data\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t};\n\t\t});\n\t};\n\n\tconst loadFilesFromUpload = (e: Event) => {\n\t\tconst target = e.target as HTMLInputElement;\n\n\t\tif (!target.files) return;\n\t\tloadFiles(target.files);\n\t};\n\n\tconst loadFilesFromDrop = (e: DragEvent) => {\n\t\tdragging = false;\n\t\tif (!e.dataTransfer?.files) return;\n\t\tloadFiles(e.dataTransfer.files);\n\t};\n</script>\n\n<div\n\tclass=\"w-full cursor-pointer h-full  items-center justify-center text-gray-400 md:text-xl {boundedheight\n\t\t? 'min-h-[10rem] md:min-h-[15rem] max-h-[15rem] xl:max-h-[18rem] 2xl:max-h-[20rem]'\n\t\t: ''}\"\n\tclass:text-center={center}\n\tclass:flex\n\ton:drag|preventDefault|stopPropagation\n\ton:dragstart|preventDefault|stopPropagation\n\ton:dragend|preventDefault|stopPropagation\n\ton:dragover|preventDefault|stopPropagation\n\ton:dragenter|preventDefault|stopPropagation\n\ton:dragleave|preventDefault|stopPropagation\n\ton:drop|preventDefault|stopPropagation\n\ton:click={openFileUpload}\n\ton:drop={loadFilesFromDrop}\n\ton:dragenter={updateDragging}\n\ton:dragleave={updateDragging}\n>\n\t<slot />\n\t<input\n\t\tclass=\"hidden-upload hidden\"\n\t\ttype=\"file\"\n\t\tbind:this={hidden_upload}\n\t\ton:change={loadFilesFromUpload}\n\t\taccept={filetype}\n\t\tmultiple={file_count === \"multiple\" || undefined}\n\t\twebkitdirectory={file_count === \"directory\" || undefined}\n\t\tmozdirectory={file_count === \"directory\" || undefined}\n\t/>\n</div>\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;4BAiGU;8CACE,WAAe,cAAc;mEACtB,WAAe,eAAe,MAAS;6DAC1C,WAAe,eAAe,MAAS;kIA1BqC,UACxF,oFACA;uCACgB;;;;AAJpB;;;;;AAmBC;;;;;kCAIY;;;;;;;;+BAVF;8BACD;mCACK;mCACA;;;;;;;;;;;;8BAQL;;qFACE,YAAe,cAAc;;;mGACtB,YAAe,eAAe;;;6FACjC,YAAe,eAAe;;;iKA1B8C,WACxF,oFACA;;;;yCACgB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAzER,WAA+B;QAC/B,wBAAwB;QACxB,WAAW;QACX,gBAAyB;QACzB,SAAkB;QAClB,OAAgB;QAChB,aAAqB;QACrB,gBAAgB;MAEvB;QAEE,WAAW;QAEX;qBACL,YAAY,QAAQ;AAAA;QAGf;QACD;;oBACJ,cAAc,QAAQ;AACtB,kBAAc;;QAGT,YAAa;QACd,SAAsB,MAAM,KAAK,KAAK;SACrC,MAAM,WAAW,OAAO;;;QAGzB,eAAe;AAClB,gBAAU,MAAM;;QAEb;AACJ,WAAO,SAAS,GAAG;UACd,gBAAgB;AACpB,gBAAU,cAAc,CAAC;AACzB,gBAAU;AACT,sBAAc,KAAK;UAEhB,MAAM,EAAE;AAAA,UACR,MAAM,EAAE;AAAA,UACR,MAAM,KAAK;AAAA,YAEV,KAAK;YAER,cAAc,OAAQ,OAAM,MAAM,MAAS,EAAE,WAAW,MAAM;AAE9D,mBACC,QACA,cAAc,WAAW,cAAc,KAAK,aAAa;AAAA;;;;QAOxD,sBAAuB;UACtB,SAAS,EAAE;SAEZ,OAAO;;AACZ,cAAU,OAAO,KAAK;AAAA;QAGjB,oBAAqB;;qBAC1B,WAAW,KAAK;SACX,SAAE,iBAAF,mBAAgB;;AACrB,cAAU,EAAE,aAAa,KAAK;AAAA;;;;;;;;;;;;;;;;;;;;;;;;AA0BnB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}