{"version":3,"file":"index17.js","sources":["../../app/src/components/Gallery/Gallery.svelte","../../app/src/components/Gallery/index.ts"],"sourcesContent":["<script lang=\"ts\">\n\timport { Block, BlockLabel } from \"@gradio/atoms\";\n\timport { ModifyUpload } from \"@gradio/upload\";\n\timport { tick } from \"svelte\";\n\timport type { LoadingStatus } from \"../StatusTracker/types\";\n\timport StatusTracker from \"../StatusTracker/StatusTracker.svelte\";\n\timport type { Styles } from \"@gradio/utils\";\n\timport { get_styles } from \"@gradio/utils\";\n\timport { Image } from \"@gradio/icons\";\n\timport type { FileData } from \"@gradio/upload\";\n\timport { normalise_file } from \"@gradio/upload\";\n\timport { _ } from \"svelte-i18n\";\n\n\texport let loading_status: LoadingStatus;\n\texport let show_label: boolean;\n\texport let label: string;\n\texport let root: string;\n\texport let root_url: null | string;\n\texport let elem_id: string = \"\";\n\texport let visible: boolean = true;\n\texport let value: Array<string> | Array<FileData> | null = null;\n\texport let style: Styles = {};\n\n\t$: _value =\n\t\tvalue === null\n\t\t\t? null\n\t\t\t: value.map((img) =>\n\t\t\t\t\tArray.isArray(img)\n\t\t\t\t\t\t? [normalise_file(img[0], root_url ?? root), img[1]]\n\t\t\t\t\t\t: [normalise_file(img, root_url ?? root), null]\n\t\t\t  );\n\n\tlet prevValue: string[] | FileData[] | null = null;\n\tlet selected_image: number | null = null;\n\t$: if (prevValue !== value) {\n\t\tselected_image = null;\n\t\tprevValue = value;\n\t}\n\n\t$: previous =\n\t\t((selected_image ?? 0) + (_value?.length ?? 0) - 1) % (_value?.length ?? 0);\n\t$: next = ((selected_image ?? 0) + 1) % (_value?.length ?? 0);\n\n\tfunction on_keydown(e: KeyboardEvent) {\n\t\tswitch (e.code) {\n\t\t\tcase \"Escape\":\n\t\t\t\te.preventDefault();\n\t\t\t\tselected_image = null;\n\t\t\t\tbreak;\n\t\t\tcase \"ArrowLeft\":\n\t\t\t\te.preventDefault();\n\t\t\t\tselected_image = previous;\n\t\t\t\tbreak;\n\t\t\tcase \"ArrowRight\":\n\t\t\t\te.preventDefault();\n\t\t\t\tselected_image = next;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t$: scroll_to_img(selected_image);\n\n\tlet el: Array<HTMLButtonElement> = [];\n\tlet container: HTMLDivElement;\n\n\tasync function scroll_to_img(index: number | null) {\n\t\tif (typeof index !== \"number\") return;\n\t\tawait tick();\n\n\t\tel[index].focus();\n\n\t\tconst { left: container_left, width: container_width } =\n\t\t\tcontainer.getBoundingClientRect();\n\t\tconst { left, width } = el[index].getBoundingClientRect();\n\n\t\tconst relative_left = left - container_left;\n\n\t\tconst pos =\n\t\t\trelative_left + width / 2 - container_width / 2 + container.scrollLeft;\n\n\t\tcontainer.scrollTo({\n\t\t\tleft: pos < 0 ? 0 : pos,\n\t\t\tbehavior: \"smooth\"\n\t\t});\n\t}\n\n\t$: can_zoom = window_height >= height;\n\n\t$: ({ classes } = get_styles(style, [\"grid\"]));\n\n\tlet height = 0;\n\tlet window_height = 0;\n</script>\n\n<svelte:window bind:innerHeight={window_height} />\n\n<Block\n\t{visible}\n\tvariant=\"solid\"\n\tcolor=\"grey\"\n\tpadding={false}\n\t{elem_id}\n\tdisable={typeof style.container === \"boolean\" && !style.container}\n>\n\t<StatusTracker {...loading_status} />\n\t{#if show_label}\n\t\t<BlockLabel\n\t\t\t{show_label}\n\t\t\tIcon={Image}\n\t\t\tlabel={label || \"Gallery\"}\n\t\t\tdisable={typeof style.container === \"boolean\" && !style.container}\n\t\t/>\n\t{/if}\n\t{#if value === null || _value === null}\n\t\t<div class=\"h-full min-h-[15rem] flex justify-center items-center\">\n\t\t\t<div class=\"h-5 dark:text-white opacity-50\"><Image /></div>\n\t\t</div>\n\t{:else}\n\t\t{#if selected_image !== null}\n\t\t\t<div\n\t\t\t\ton:keydown={on_keydown}\n\t\t\t\tclass=\"absolute group inset-0 z-10 flex flex-col bg-white/90 dark:bg-gray-900 backdrop-blur h-full\"\n\t\t\t\tclass:min-h-[350px]={style.height !== \"auto\"}\n\t\t\t\tclass:max-h-[55vh]={style.height !== \"auto\"}\n\t\t\t\tclass:xl:min-h-[450px]={style.height !== \"auto\"}\n\t\t\t>\n\t\t\t\t<ModifyUpload on:clear={() => (selected_image = null)} />\n\n\t\t\t\t<img\n\t\t\t\t\ton:click={() => (selected_image = next)}\n\t\t\t\t\tclass=\"w-full object-contain h-[calc(100%-50px)\"\n\t\t\t\t\tsrc={_value[selected_image][0].data}\n\t\t\t\t\talt={_value[selected_image][1] || \"\"}\n\t\t\t\t\ttitle={_value[selected_image][1] || null}\n\t\t\t\t\tstyle=\"height: calc(100% - {_value[selected_image][1]\n\t\t\t\t\t\t? '80px'\n\t\t\t\t\t\t: '60px'})\"\n\t\t\t\t/>\n\t\t\t\t{#if _value[selected_image][1]}\n\t\t\t\t\t<div class=\"bottom-[50px] absolute z-[5] flex justify-center w-full\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\" dark:text-gray-200 font-semibold px-3 py-1 max-w-full truncate\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{_value[selected_image][1]}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t\t<div\n\t\t\t\t\tbind:this={container}\n\t\t\t\t\tclass=\"absolute h-[60px] overflow-x-scroll scroll-hide w-full bottom-0 flex gap-1.5 items-center py-2 text-sm px-3 justify-center\"\n\t\t\t\t>\n\t\t\t\t\t{#each _value as image, i}\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tbind:this={el[i]}\n\t\t\t\t\t\t\ton:click={() => (selected_image = i)}\n\t\t\t\t\t\t\tclass=\"gallery-item !flex-none !h-9 !w-9 transition-all duration-75 {selected_image ===\n\t\t\t\t\t\t\ti\n\t\t\t\t\t\t\t\t? '!ring-2 !ring-orange-500 hover:!ring-orange-500'\n\t\t\t\t\t\t\t\t: 'scale-90 transform'}\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\tclass=\"h-full w-full overflow-hidden object-contain\"\n\t\t\t\t\t\t\t\tsrc={image[0].data}\n\t\t\t\t\t\t\t\ttitle={image[1] || null}\n\t\t\t\t\t\t\t\talt={image[1] || null}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t{/each}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{/if}\n\n\t\t<div\n\t\t\tbind:clientHeight={height}\n\t\t\tclass=\"overflow-y-auto h-full p-2\"\n\t\t\tclass:min-h-[350px]={style.height !== \"auto\"}\n\t\t\tclass:max-h-[55vh]={style.height !== \"auto\"}\n\t\t\tclass:xl:min-h-[450px]={style.height !== \"auto\"}\n\t\t>\n\t\t\t{#if _value.length === 0}\n\t\t\t\t<div class=\"h-full min-h-[15rem] flex justify-center items-center\">\n\t\t\t\t\t<div class=\"h-5 dark:text-white opacity-50\"><Image /></div>\n\t\t\t\t</div>\n\t\t\t{:else}\n\t\t\t\t<div class=\"grid gap-2 {classes}\" class:pt-6={show_label}>\n\t\t\t\t\t{#each _value as [image, caption], i}\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"gallery-item group\"\n\t\t\t\t\t\t\ton:click={() => (selected_image = can_zoom ? i : selected_image)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\talt={caption || \"\"}\n\t\t\t\t\t\t\t\tclass=\"h-full w-full overflow-hidden object-contain\"\n\t\t\t\t\t\t\t\tsrc={typeof image === \"string\" ? image : image.data}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{#if caption}\n\t\t\t\t\t\t\t\t<div class=\"bottom-0 absolute z-[5] flex justify-end w-full\">\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclass=\"bg-gray-50 dark:bg-gray-700 dark:text-gray-200 text-xs border-t border-l dark:border-gray-600 font-semibold px-3 py-1 rounded-tl-lg group-hover:opacity-50 max-w-full truncate\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{caption}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t{/each}\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</div>\n\t{/if}\n</Block>\n\n<style lang=\"postcss\">\n\t.gallery-item {\n\t\t@apply rounded shadow-sm relative aspect-square h-full hover:brightness-110 focus:ring-blue-500 focus:ring-2 ring-1 ring-gray-200 hover:ring hover:ring-orange-300 w-full overflow-hidden bg-gray-100 dark:bg-gray-900 object-fill outline-none;\n\t}\n</style>\n","export { default as Component } from \"./Gallery.svelte\";\nexport const modes = [\"static\"];\n\nexport const document = (config: Record<string, any>) => ({\n\ttype: \"Array<{ name: string } | [{ name: string }, string]>\",\n\tdescription: \"list of objects with filename and optional caption\"\n});\n"],"names":[],"mappings":"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"}