---
# minio container
- name: Add default bucket
  file:
    path: "{{ minio_data_dir }}/{{ minio_default_bucket }}"
    state: directory
    mode: '644'

- name: Start minio
  community.docker.docker_container:
    name: minio_by_bootstrap
    image: "{{ minio_image }}"
    command: "server /data --console-address ':{{ minio_console_port }}'"
    state: started
    pull: true
    restart_policy: always
    ports:
      - "{{ minio_server_port }}:9000"
      - "{{ minio_console_port }}:9001"
    env:
      MINIO_ROOT_USER: "{{ minio_access_key }}"
      MINIO_ROOT_PASSWORD: "{{ minio_secret_key }}"
      MINIO_BUCKET: "{{ minio_default_bucket }}"
    volumes:
      - "{{ minio_data_dir }}:/data"
